estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))),method="centroid");
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
x11();plot(hc.manual)
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))),method="ward");
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
x11();plot(hc.manual)
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))),method="median");
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
x11();plot(hc.manual)
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
x11();plot(manualTree)
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))),method="average");
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
x11();plot(manualTree)
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
dev.off()
dev.off()
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))),method="average");
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
manualTree.nj = NJ(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
x11();plot(manualTree.nj)
source("loadData.R")
source("loadData.R")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
hc.manual
x11();plot(reverseLabels(pos21tree)
x11();plot(reverseLabels(pos21tree))
dev.off()
dev.off()
x11();plot(reverseLabels(pos21tree))
#parameters for the manual distance calculation
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 5, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 6, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
#save the tree in PDF format
ggsave(paste(plotsPath,"membow_",fileName,"_tree.pdf",sep=""), device=cairo_pdf)
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 6, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 6, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
plot(hc.manual)
#parameters for the manual distance calculation
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
#parameters for the manual distance calculation
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 2, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 7, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
#save the tree in PDF format
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 7, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc.manual, k = 1, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
#save the tree in PDF format
x11();plot(hc.manual)
source("loadData.R")
fviz_dend(hc.manual, k = 5, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc.manual, k = 6, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
#save the tree in PDF format
fviz_dend(hc.manual, k = 7, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc.manual, k = 8, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc.manual, k = 9, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc.manual, k = 2, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc, k = 4, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
x11();plot(hc)
x11();plot(hc.manual)
summary(hc.manual)
summary(hc)
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
source("loadData.R")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
source("loadData.R")
dev.off()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
dev.off()
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
source("loadData.R")
source("loadData.R")
dev.off()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
fviz_dend(hc.manual, k = 6, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
fviz_dend(hc.manual, k = 7, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
manualDist(as.character(barcodes),estimMu,estimAlpha,estimG )
x11();plot(manualTree)
x11();plot(manualTree)
x11();plot(hc.manual)
fviz_dend(hc.manual, k = 5, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
fviz_dend(hc.manual, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
fviz_dend(hc.manual, k = 7, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
fviz_dend
hc.manual
attributes(hc.manual)
fviz_dend(hc, k = 4, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
fviz_dend(hc, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco", rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco", rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
barcods
barcodes
d=as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG )))
d
x11();plot(manualTree)
source("loadData.R")
dev.off()
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 7, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
manualDist
fviz_dend(hc, k = 4, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
manualTree
print(manualTree)
manualTree$tip.label
hc.manual
hc
dev.off()
fviz_dend(hc, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
dev.off()
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,ylab="time",xlab="cells",main="manual dist")
source("loadData.R")
getwd()
setwd("../GraceData/")
source("loadData.R")
pos21tree=read.tree(file=paste(fileName,".nwk",sep=""))
posInfo=read.csv(paste(fileName,".csv",sep=""))
barcodes = posInfo$Summary[!is.na(posInfo$Movie.ID) & !posInfo$Summary=="xxxxxx"]
names(barcodes) =posInfo$Movie.ID[!is.na(posInfo$Movie.ID)  & !posInfo$Summary=="xxxxxx"]
#nuclear.cfp = posInfo$
fastaBarcodes = convertSimToFasta(barcodes)
fasIN <-paste(fileName,".fas",sep="")
write(fastaBarcodes,file=fasIN)
convertMemoirToDNA(fasIN)
#sequences have a "c" at the end
#now we can use the phyDat
memoirfas<-read.phyDat(fasIN,format="fasta",type="DNA")
dm<-dist.ml(memoirfas,model="F81")
dm.ham=dist.hamming(memoirfas)
print("distance calculated")
treeUPGMA<-upgma(dm)
treeUPGMA.ham <-upgma(dm.ham)
hc=as.hclust(reverseLabels(treeUPGMA))
fviz_dend(hc, k = 4, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
hc
library(factoextra)
fviz_dend(hc, k = 4, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
x11()
fviz_dend(hc.manual, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
#plotting the r
fviz_dend(hc, k = 4, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
hc=as.hclust(reverseLabels(treeUPGMA))
x11()
fviz_dend(hc, k = 3, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
fviz_dend(hc, k = 3, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
fviz_dend(hc, k = 4, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
fviz_dend(hc, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
x11();plot(reverseLabels(pos21tree))
source("loadData.R")
fviz_dend(hc, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
x11()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
x11()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
source("loadData.R")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
x11()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
x11();plot(hc)
x11();plot(hc.manual)
fviz_dend(hc, k = 3, # Cut in four groups
cex = 0.9, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE, # Add rectangle around groups
rect_border = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
rect_fill = TRUE,
main="reconstructed lineage (membow)",
xlab="cells",ylab="time")
fviz_dend(hc, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
x11()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
browser()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
x11()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
#plotting the real tree
#split the name of the tips //Grace named them as 180_xx so we split using _
d=manualDist(as.character(barcodes),estimMu,estimAlpha,estimG )
d
is.nan(d)
is.inf(d)
d
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
x11()
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
hc.manual=as.hclust(reverseLabels(manualTree))
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend
hc.manual
manualTree
treeUPGMA
reverseLabels(manualTree)
maualTree
manualTree
reverseLabels(manualTree)
barcodes
paste(names(barcodes),barcodes,sep='')
paste(names(barcodes),barcodes,sep='_')
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
#hc.manual=as.hclust(reverseLabels(manualTree))
hc.manual=as.hclust(manualTree)
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells",main="manual dist")
fviz_dend(hc, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
estimMu = 0.3
estimAlpha=2/3
estimG = 3
manualTree = upgma(as.dist(t(manualDist(as.character(barcodes),estimMu,estimAlpha,estimG ))));
manualTree$tip.label<- paste(names(barcodes),barcodes,sep="_")
#hc.manual=as.hclust(reverseLabels(manualTree))
hc.manual=as.hclust(manualTree)
# for saving ggsave("membow_31_2tree.pdf", device=CairoPDF)
fviz_dend(hc.manual, k = 3, cex = 0.8, horiz = TRUE,  k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE,xlab="time",ylab="cells")
